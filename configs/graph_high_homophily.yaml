# HIGH FRAUD-CLASS HOMOPHILY configuration
#
# Goal: Produce a dataset with the same scale and edge count as graph_low_homophily.yaml,
# but where fraudulent edges cluster tightly together in the graph (high homophily).
#
# Design choices:
# - Layering (2-5 hops) + TIGHT entity pool creates dense fraud chains
#   that reuse the same intermediary nodes. Low-homophily uses 4-8 hops + BROAD
#   pool, spreading chains across unrelated intermediaries.
# - REDUCED legitimateHighRiskActivity: fewer legitimate edges around fraud
#   entities so fraud edges are a larger fraction of each node's neighborhood.
# - Tight fraud entity pool: high min_risk_score (0.70) means only a small set
#   of entities participate in fraud, so patterns reuse the same nodes.
# - High reuse probability: 0.30 base probability means fraud entities are
#   selected repeatedly across different patterns.
# - high_risk_ratio: 0.80 means 80% of pattern participants come from the same
#   high-risk clusters, concentrating fraud edges in tight neighborhoods.
# - Background patterns match graph_low_homophily.yaml for comparable edge volume.
#
# Differences vs graph_low_homophily.yaml:
#   - layering_config: 2-5 hops (vs 4-8) + tight pool — reused intermediaries
#   - fraud_selection_config: tight entity pool (vs broad) — reuse intermediaries
#   - legitimateHighRiskActivity: reduced (weight=0.05, fraction=0.30, txns=[2,8])

graph_scale:
  individuals: 8000
  institutions_per_country: 1
  individual_accounts_per_institution_range: [1, 3]
  business_accounts_per_institution_range: [1, 5]

target_fraud_ratio: 0.0003

institution_filter_country: null

transaction_rates:
  per_account_per_day: 1.5
time_span:
  start_date: '2025-01-01T00:00:00'
  end_date: '2025-12-31T23:59:59'
account_balance_range_normal: [1000.0, 50000.0]

company_size_range: [1, 1000]
random_seed: 42
business_creation_date_range: [90, 5475]

backgroundPatterns:
  randomPayments:
    weight: 0.35
    legit_rate_multiplier: [0.3, 0.8]
    transaction_type_probabilities:
      transfer: 0.20
      payment: 0.45
      deposit: 0.20
      withdrawal: 0.15
    amount_ranges:
      payment: [10.0, 500.0]
      transfer: [5.0, 300.0]
      cash_operations: [20.0, 500.0]
    structured_amount_probability: 0.03
    structuring_range: [7000.0, 9900.0]
    burst_probability: 0.10
    burst_duration_minutes: 240

  salaryPayments:
    weight: 0.08
    payment_intervals: [14, 30]
    salary_range: [2500.0, 7500.0]
    salary_variation: 0.05
    preferred_payment_days: [1, 15, 30]

  # REDUCED for high homophily: this pattern specifically adds legitimate edges
  # to fraudulent entities (~73 legit txns/fraudster over 365 days at default rate).
  # Low-homophily config uses weight=0.25.
  fraudsterBackground:
    weight: 0.001

  legitimateHighPayments:
    weight: 0.08
    high_payment_ranges:
      property_transactions: [50000.0, 500000.0]
      business_deals: [10000.0, 100000.0]
      luxury_purchases: [5000.0, 50000.0]
    high_payment_type_probabilities:
      property: 0.2
      business: 0.5
      luxury: 0.3
    high_payment_rate_per_month: 0.1

  legitimateBurst:
    weight: 0.08
    burst_user_fraction: 0.05
    burst_size_range: [3, 8]
    amount_range: [20.0, 300.0]
    time_between_txs_minutes: [10, 120]
    include_cash_ops: true
    cash_ops_probability: 0.10
    cash_amount_range: [50.0, 300.0]
    bursts_per_user_range: [1, 2]
    structuring_burst_probability: 0.05
    structuring_amount_range: [7000.0, 9900.0]

  legitimateCashOperations:
    weight: 0.15
    cash_user_fraction: 0.35
    operations_per_month_range: [2, 8]
    withdrawal_amount_range: [20.0, 500.0]
    deposit_amount_ranges:
      small: [50.0, 500.0]
      medium: [500.0, 2000.0]
      large: [2000.0, 5000.0]
      very_large: [7500.0, 9999.0]
    deposit_probabilities:
      small: 0.45
      medium: 0.28
      large: 0.15
      very_large: 0.12
    deposit_probability: 0.35
    rapid_deposit_mode:
      enabled: true
      probability: 0.08
      deposits_per_sequence: [2, 4]
      interval_days: [1, 5]

  legitimatePeriodicPayments:
    weight: 0.12
    periodic_user_fraction: 0.4
    payment_intervals: [7, 14, 30]
    amount_ranges:
      small_bills: [20.0, 200.0]
      medium_bills: [200.0, 1000.0]
      large_bills: [1000.0, 5000.0]
      very_large: [7500.0, 9999.0]
    amount_probabilities:
      small_bills: 0.38
      medium_bills: 0.32
      large_bills: 0.20
      very_large: 0.10
    subscriptions_per_user_range: [1, 4]

  legitimateChains:
    weight: 0.12
    num_chains_per_generation: 50
    amount_decay_range: [0.95, 1.0]

  legitimateStructuring:
    weight: 0.05
    user_fraction: 0.04
    deposit_amount_range: [7500.0, 9999.0]
    deposits_per_month_range: [1, 3]
    burst_probability: 0.15

  legitimateRapidFlow:
    weight: 0.05
    events_per_1000_users: 15
    inflows_per_event: [2, 5]
    outflows_per_event: [1, 4]
    amount_range: [500.0, 3000.0]
    inflow_to_outflow_delay_hours: [4, 72]
    structuring_amount_probability: 0.05
    structuring_amount_range: [7000.0, 9900.0]

  # REDUCED for high homophily: less legitimate noise around fraud entities
  # so fraud edges are a larger fraction of each fraud node's neighborhood.
  # Low-homophily config uses weight=0.25, fraction=0.95, txns=[15,40].
  legitimateHighRiskActivity:
    weight: 0.01
    activity_fraction: 0.15
    transactions_per_account_range: [1, 4]
    amount_ranges:
      small: [20.0, 200.0]
      medium: [200.0, 1000.0]
      large: [1000.0, 5000.0]
    amount_probabilities:
      small: 0.50
      medium: 0.35
      large: 0.15

pattern_frequency:
  random: True
  num_illicit_patterns: 70

  RapidFundMovement: 33
  FrontBusinessActivity: 33
  RepeatedOverseasTransfers: 33
  UTurnTransactions: 901

# Layering for high edge-label homophily:
# Longer chains (2-5 hops, same as graph_HI/LI) create more fraud-edge overlap
# at intermediary nodes. Combined with the TIGHT entity pool, the same
# intermediaries appear in multiple patterns, accumulating fraud edges.
# Low-homophily config uses 4-8 hops with a BROAD entity pool — longer chains
# but spread across unrelated intermediaries, so no node accumulates many.
layering_config:
  enabled: true
  min_extra_hops: 2
  max_extra_hops: 5
  use_legit_amounts: true
  hop_delay_hours: [1, 48]
  amount_decay_range: [0.95, 0.99]
  # Route layering hops through high-risk entity accounts instead of random
  # accounts. This causes the same intermediary nodes to appear across multiple
  # fraud chains, concentrating fraud edges and raising edge-label homophily.
  use_clustered_intermediaries: true

reporting_threshold: 10000
reporting_currency: 'USD'
high_risk_business_probability: 0.05
random_business_probability: 0.15
offshore_account_probability: 0.1

high_transaction_amount_ratio: 0.05
low_transaction_amount_ratio: 0.1

account_categories:
  - "Current"
  - "Savings"
  - "Loan"

high_risk_config:
  countries_weight_factor: 1.0
  business_categories_weight_factor: 1.0
  company_size_thresholds:
    very_small_max: 5

risk_weights:
  base_individual: 0.05
  base_business: 0.10
  age_group: 0.15
  occupation: 0.12
  country: 0.2
  business_category: 0.25
  very_small_company: 0.10
  max_score: 1.0

# TIGHT fraud entity pool: concentrates fraud among the same entities
# This is the ONLY section that differs from graph_low_homophily.yaml
fraud_selection_config:
  min_risk_score_for_fraud_consideration: 0.70  # Low-homophily: 0.25
  base_fraud_probability_if_considered: 0.30    # Low-homophily: 0.05
  high_risk_ratio: 0.80                         # Low-homophily: 0.15
